// ================= UNREALIRCD KOMPLETTE KONFIGURATION =================
include "default.conf";
include "tls.conf";

// ================= NETZWERK GRUNDEINSTELLUNGEN =================
set {
    network-name = "AetheronIRC";
    default-server = "irc.aetheron.local";
    services-server = "services.aetheron.local";
    help-channel = "#help";
    hiddenhost-prefix = "user";
    modes-on-connect = "+ix";
    modes-on-oper = "+xwgs";
    oper-auto-join = "#opers";
    maxchannelsperuser = 20;
    anti-flood { unknown-flood-amount = 10; unknown-flood-period = 10s; };
    options { identd-check; hide-ulines; show-connect-info; flat-map; no-stealth; };
};

// ================= LISTEN PORTS (NUR SSL/TLS!) =================
listen { ip *; port 6697; options { ssl; } };
listen { ip *; port 6997; options { tls; } };

// ================= KLASSEN DEFINITION =================
class clients { pingfreq 90s; connfreq 15s; maxclients 5000; sendq 1M; recvq 8192; };
class opers { pingfreq 90s; connfreq 15s; maxclients 100; sendq 10M; recvq 32768; options { nofakelag; }; };
class servers { pingfreq 90s; connfreq 15s; maxclients 10; sendq 20M; recvq 65536; };
class limusers { pingfreq 90s; connfreq 15s; maxclients 30; sendq 1M; recvq 8192; };

// ================= OPERATOR KONFIGURATION =================
oper admin {
    class opers; mask *; password "DEIN_OPER_PASSWORT"; operclass netadmin;
    swhois "Network Administrator"; modes +xwgs; snomask +cFfkoO; maxlogins 5;
};

// ================= SSL/TLS KONFIGURATION =================
ssl {
    certificate = "/pfad/zu/cert.pem";
    key = "/pfad/zu/key.pem";
    options {
        no_plaintext; no_tlsv1; no_tlsv1_1;
        cipherlist "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH";
    };
};

// ================= ZUGRIFFSREGELN =================
allow { ip *; class clients; maxperip 3; };
allow { ip 192.168.1.*; class clients; maxperip 10; password "lan123"; };
allow { ip 10.0.0.*; class clients; maxperip 8; password "vpn123"; };

// ================= FLOOD PROTECTION =================
set {
    anti-flood {
        connect-flood 5:60; nick-flood 5:60; away-flood 5:120;
        invite-flood 3:60; knock-flood 3:60; max-concurrent-conversations 5;
        unknown-flood-amount 10; unknown-flood-period 10s;
    };
};

// ================= CHANNEL EINSTELLUNGEN =================
set {
    default-channel { modes = "+nt"; topic = "Welcome to AetheronIRC"; };
    channel { use-exempt = yes; use-invite = yes; use-forward = yes; use-knock = yes; };
    max-ban-entries = 200; max-join-entries = 200; max-watch-entries = 200;
};

// ================= CLIENT LIMITS =================
set {
    max-users = 5000; nick-length = 30; topic-length = 390;
    away-length = 390; kick-length = 390; max-list-size = 100000;
};

// ================= WHOWAS EINSTELLUNGEN =================
whowas { entries = 32768; duration = 30d; };

// ================= LOGGING KONFIGURATION =================
log { destination file "/home/khryon/logs/unrealircd.log"; flags { connect; oper; kills; errors; server-connects; chg-commands; }; };
log { destination file "/home/khryon/logs/oper.log"; flags { oper; }; };

// ================= BLOCKIERE PLAIN TEXT PORT =================
deny { mask *; port 6667; reason "Use SSL/TLS on port 6697 or 6997"; };